<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
    <div class="container-fluid">
        <div id="chat-box">
            <div id="info-support">
                <div id="profil-pic-aquas">
                    <img src="images/aquas_logo.png" alt="logo not found">
                </div>
                <div class="w-space"></div>
                <p id="aquas-name">AQUAS Support</p>
            </div>

            <div id="date-of-day"></div>

            <div class="h-space"></div>

            <div class="print-zone">
                <div id="userquestion-box" align="right"></div>

                <div class="h-space"></div>

                <div id="aquasresponse-box" align="left"></div>
            </div>

            <div class="h-space"></div>

            <div class="inputbox">
                <input id="user-input" class="form-control" type="text" name="userInput" placeholder="Entrez votre message..." required>
                <div class="w-space"></div>
                <img id="send-msg" src="images/send_message.png" alt="logo not found">
            </div>
        </div>

        <script>
            function actualTime() {
                var now = new Date();
                var heure = ('0' + now.getHours()).slice(-2);
                var minute = ('0' + now.getMinutes()).slice(-2);
                var seconde = ('0' + now.getSeconds()).slice(-2);
                return heure + ':' + minute + ':' + seconde;
            }

            function dateOfTheDay() {
                var now = new Date();
                var annee = now.getFullYear();
                var mois = now.getMonth() + 1;
                var jour = now.getDate();
                // var mois = ('0' + now.getMonth() + 1).slice(-2);
                // var jour = ('0' + now.getDate()).slice(-2);
                return '<div class="line"></div><p>' + jour + '/' + mois + '/' + annee + '</p><div class="line"></div>'
            }

            var i = 0;
            $("#date-of-day").append(dateOfTheDay());

            function getResponse() {
                let userText = $("#user-input").val();
                let userHtml = '<table><tbody><tr><td></td><td><p id="time-question-' + i + '" class="time"></p></td><td><div class="w-space-5"></div></td><td><div class="user-question"><p>' + userText + '</p></div></td></tr></tbody></table><div class="h-space"></div>';
                $("#user-input").val("");
                $("#userquestion-box").append(userHtml);
                $("#time-question-" + i).append(actualTime());
                i++;
                console.log(i);

                $.get("/get", {
                    msg: userText
                }).done(function(data) {
                    var botHtml = '<table><tbody><tr><td><div id="profil-pic-aquas"><img src="images/aquas_logo.png" alt="logo not found"></div></td><td><div class="w-space-5"></div></td><td><div class="aquas-response' + i + '" class="time"><p>' + data + '</p></div></td><td><div class="w-space-5"></div></td><td><p id="time-answer"></p></td></tr></tbody></table><div class="h-space"></div>';
                    $("#aquasresponse-box").append(botHtml);
                    $("#time-answer" + i).append(actualTime());
                    i++;
                });
            }
            $("#user-input").keypress(function(e) {
                if (e.which == 13) {
                    getResponse();
                }
            });
            $("#send-msg").click(function() {
                getResponse();
            });
        </script>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    </div>
</body>

</html>